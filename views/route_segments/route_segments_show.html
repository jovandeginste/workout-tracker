<!doctype html>
<html>
  <head>
    {{ template "head" }}
    <script src="{{ RouteFor `assets` }}/dist/leaflet.js"></script>
    <script src="{{ RouteFor `assets` }}/dist/apexcharts.min.js"></script>
    <link href="{{ RouteFor `assets` }}/dist/leaflet.css" rel="stylesheet" />
  </head>
  <body>
    {{ template "header" . }}
    <div class="content">
      {{ with .routeSegment }}
      <div class="gap-4">
        <span class="float-right actions">
          {{ if .Dirty }}
          <span class="dirty {{ IconFor `refresh` }}">
            {{ i18n "refresh in progress" }}
          </span>
          {{ end }} {{ template "route_segment_actions" . }}
        </span>

        <h2 class="{{ IconFor `route-segment` }}">{{ .Name }}</h2>
      </div>
      <div class="lg:flex lg:flex-wrap print:block">
        <div class="basis-1/2 2xl:basis-1/3 pagebreak">
          <div class="inner-form">{{ template "route_segment_map" . }}</div>
        </div>
        <div class="basis-1/2 2xl:basis-1/3">
          <div class="inner-form">{{ template "route_segment_details" . }}</div>
        </div>
        <div class="basis-1/2 2xl:basis-1/3">
          <div
            class="inner-form overflow-y-auto max-h-[340px] sm:max-h-[440px] md:max-h-[640px] print:max-h-[640px]"
          >
            <table>
              <thead>
                <tr>
                  <th>{{ i18n "User" }}</th>
                  <th>{{ i18n "Workout" }}</th>
                  <th>{{ i18n "Distance" }}</th>
                  <th>{{ i18n "Duration" }}</th>
                  <th>{{ i18n "Tempo" }}</th>
                </tr>
              </thead>
              <tbody>
                {{ range .RouteSegmentMatches }}
                <tr>
                  <td>
                    <a href="{{ RouteFor `user-show` .Workout.UserID }}"
                      >{{ .Workout.User.Name }}</a
                    >
                  </td>
                  <td>
                    <a href="{{ RouteFor `workout-show` .WorkoutID }}"
                      >{{ .Workout.Name }}</a
                    >
                  </td>
                  <td class="whitespace-nowrap font-mono">
                    {{ .Distance | HumanDistance }} {{
                    CurrentUser.PreferredUnits.Distance }}
                  </td>
                  <td class="whitespace-nowrap font-mono">
                    {{ .Duration | HumanDuration }}
                  </td>
                  <td class="whitespace-nowrap font-mono">
                    {{ .AverageSpeed | HumanTempo }} {{
                    CurrentUser.PreferredUnits.Tempo }}
                  </td>
                </tr>
                {{ end }}
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="inner-form h-[300px] md:h-[500px] print:hidden">
        <h3>
          <span>{{ i18n "Personal trend" }}</span>
        </h3>
        {{ template "route_segment_show_stats" . }}
      </div>

      <div class="pagebreak">
        {{ if .Notes }}
        <div class="inner-form">
          <h3 class="{{ IconFor `note` }}">{{ i18n "Notes" }}</h3>
          <div>{{ .MarkdownNotes }}</div>
        </div>
        {{ end }}
      </div>
      {{ end }}
    </div>

    {{ template "footer" . }}
  </body>
</html>
